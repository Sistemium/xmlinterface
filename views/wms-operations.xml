<?xml version="1.0"?>
<view-definition xmlns="http://unact.net/xml/xi" name="wms-operations" label="Задания штабелеру">
    <view-schema>
        <form name="sysuser">
            <parameter name="name">
                <init with="username"/>
            </parameter>
            <field name="id" />
            <form name="wms-operation-request" label="Задание">
                <field name="id" />
                <field name="is-done" label="Выполнено" editable="true" autosave="true"/>
                <form name="wms-operation">
                    <field name="id" />
                    <field name="name" label="Операция"/>
                </form>
                <form name="wms-place">
                    <field name="id" />
                    <field name="name" label="Ячейка"/>
                </form>
                <where name="is-done" type="int">0</where>
                <order-by name="ts" dir="asc"/>
            </form>
        </form>
    </view-schema>
    <workflow>
        <step name="restart" label="Выполните задание">
            <display>
                <print form="wms-place" field="name" />
                <print form="wms-operation" field="name" />
                <input form="wms-operation-request" field="is-done" />
            </display>
            <validate>
                <equals field="is-done" type="boolean">1</equals>
            </validate>
        </step>
        <step label="Что дальше?">
            <display>
                <print form="wms-place" field="name" />
                <print form="wms-operation" field="name" />
                <print form="wms-operation-request" field="is-done" />
            </display>
            <choise>
                <option label="Продолжить">
                    <command name="refresh"/>
                    <command name="wms-operations">restart</command>
                </option>
                <option label="Закончить работу">
                    <command name="close"/>
                </option>
            </choise>
        </step>
    </workflow>
</view-definition>