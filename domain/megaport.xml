<?xml version="1.0" encoding="utf-8"?>

<domain name="megaport" xmlns="http://unact.net/xml/xi">

    <concept name="mp-agent">
        
        <select owner="megaport" sql-name="agent"/>
        
        <property name="name" label="Имя"/>
        
    </concept>


    <concept name="mp-agent-route">
        
        <select owner="megaport" sql-name="agent_route"/>
        
        <property name="date" type="date" sql-name="ddate" label="Дата"/>
        <property name="ndoc" label="Номер маршрута"/>
        
        <role name="mp-agent" actor="mp-agent" sql-name="agent"/>
        <role name="mp-zone" actor="mp-zone" sql-name="zone"/>
        
    </concept>


    <concept name="mp-agent-route-point">
        
        <select owner="megaport" sql-name="agent_route_point"/>
        
        <role name="mp-agent-route" actor="mp-agent-route" sql-name="agent_route"/>
        <role name="mp-terminal" actor="mp-terminal" sql-name="terminal"/>
        
        <property name="visited" type="boolean" label="Посещено?" />
        <property name="info" label="Пояснение" />
        
    </concept>


    <concept name="mp-terminal">
        
        <select owner="megaport" sql-name="terminal"/>
        
        <property name="lastactivitytime" type="datetime" label="Последний сигнал"/>
        <property name="lastpaymenttime" type="datetime" label="Последний платеж"/>
        <property name="error" type="string" label="Ошибка" sql-name="errortext"/>
        
        <property name="name" type="string" label="Название"/>
        <property name="address" type="string" label="Адрес"/>
        <property name="code" type="string" label="Код"/>
        <property name="terminalid" type="int" label="ID"/>
        
    </concept>
    

    <concept name="mp-zone">
        
        <select owner="megaport" sql-name="zone"/>
        
        <select owner="megaport" sql-name="zoneByUsername" type="procedure">
            <parameter name="username" sql-name="@username" required="true"/>
        </select>
        
        <property name="name" label="Название"/>
        
        <property name="agent-type" sql-name="agent_type"/>
        
    </concept>
    

    <concept name="mp-zone-terminal">
        
        <select owner="dbo" sql-name="pps_zone_terminal"/>
        
        <role name="mp-terminal" actor="mp-terminal" sql-name="pps_terminal"/>
        <role name="mp-zone" actor="mp-zone" sql-name="zoneid"/>
        
    </concept>
    
</domain>