<?xml version="1.0" encoding="utf-8"?>

<domain xmlns="http://unact.net/xml/xi" >
    
    
    <!-- sysuser dbserver-console payroll-person
        - покзательные понятия, пусть они всегда вверху будут
    -->

    <concept name="dbserver-console">
        
        <select owner="dbo" type="procedure" sql-name="sa_server_messages"/>
        
        <property name="id" type="int" sql-name="msg_id" key="true">
            <!-- должен быть ключ с @name="id" если хотим ссылаться через role -->
        </property>
        
        <property name="msg_text" type="string" label="Запись"/>
        <property name="msg_time" type="datetime"  label="Время"/>
        <property name="msg_severity" type="string" />
        <property name="msg_category" type="string" label="Категория"/>
        <property name="msg_database" type="string" label="База"
            sql-compute="isnull(msg_database,'Server itself')"/>
        
    </concept>
    

    <concept name="sysuser">
        
        <select owner="xmlgate" sql-name="agent"/>
        
        <select owner="xmlgate" type="procedure" sql-name="agent">
            <parameter name="name" type="string" sql-name="@name"/>
            <parameter name="device-name" type="string" sql-name="@deviceName"/>
        </select>
        
        <save owner="xmlgate" sql-name="agent" />
        
        <property name="id" type="int" key="true"/>
        <property name="name" type="string" label="Имя"/>
        <property name="device-name" type="string" label="Последнее использованное устройство"/>
        <property name="ts" type="datetime" label="Активность"/>
        <property name="xid"/>
        
        <role name="payroll-person" actor="payroll-person" sql-name="person"/>
        
    </concept>
    
    <!-- sysuser dbserver-console payroll-person
        - покзательные понятия, пусть они всегда вверху будут
    -->


    <concept name="cat">
        <select owner="sys" sql-name="dummy"/>
    </concept>


    <concept name="cat-file">
        
        <select owner="dbo" sql-name="xmlconfig" />
        
        <property name="xid" />
        
        <property name="id" key="true" type="int" />
        
        <property name="ts" type="datetime" label="Дата обновления" />
        
        <property name="code" type="string" label="Код" />
        <property name="data" type="file" label="XML-данные" />
        
    </concept>
    

</domain>